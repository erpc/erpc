import { Callout, Tabs, Tab } from "nextra/components";

# Complete config example

This example config demonstrates all features of eRPC in one place. For more explanation of each section, refer to dedicated pages:

- [Database](/config/database): to configure caching and database.
- [Projects](/config/projects): to define multiple projects with different rate limit budgets.
- [Networks](/config/projects/networks): to configure failsafe policies for each network.
- [Upstreams](/config/projects/upstreams): to configure upstreams with failsafe policies, rate limiters, allowed/rejected methods, etc.
- [Rate limiters](/config/rate-limiters): to configure various self-imposed budgets to prevent pressure on upstreams.
- [Failsafe](/config/failsafe): explains different policies such as retry, timeout, and hedges, used for networks and upstreams.

By default `erpc` binary will look for `./erpc.yaml` file in the current directory. You can change this path by passing an argument to the binary:

```bash
$ erpc /path/to/your/erpc.yaml
```

### Minimal `erpc.yaml`

eRPC will auto-detect or use sane defaults for various configs such as retries, timeouts, circuit-breaker, hedges, node architecture etc.

<Callout type="info">
  <b>eRPC is Multi-chain</b><br />
  A single instance of eRPC can server multiple projects (frontend, indexer, etc) and multiple chains.
</Callout>

<Tabs items={["yaml", "typescript"]}>
  <Tabs.Tab>
```yaml filename="erpc.yaml"
logLevel: debug
projects:
 - id: main
   upstreams:
   # Put all your RPC endpoints for any network here.
   # You don't need to define architecture (e.g. evm) or chain id (e.g. 42161)
   # as they will be detected automatically by eRPC.
   - endpoint: https://xxxxx.matic.quiknode.pro/xxxxxxxxxx/
   - endpoint: drpc://XXX_MY_DRPC.ORG_API_KEY_XXX # Add all supported chains of drpc.org
   - endpoint: blastapi://XXX_MY_BLASTAPI.IO_API_KEY_XXX # Add all supported chains of blastapi.io
   - endpoint: alchemy://XXX_MY_ALCHEMY.COM_API_KEY_XXX # Add all supported chains of alchemy.com
   - endpoint: envio://rpc.hypersync.xyz # Add all supported methods and chains of envio.dev HyperRPC
```
</Tabs.Tab>
  <Tabs.Tab>
```ts filename="erpc.ts"
/**
 * Converted config in TypeScript. Copy and create erpc.ts so the binary automatically imports it.
 */
import { createConfig } from "@erpc-cloud/config";

export default createConfig({
  logLevel: "debug",
  projects: [
    {
      id: "main",
      upstreams: [
        // Put all your RPC endpoints for any network here.
        // You don't need to define architecture (e.g., evm) or chainId (e.g., 42161)
        // as they will be detected automatically by eRPC.
        {
          endpoint: "https://xxxxx.matic.quiknode.pro/xxxxxxxxxx/",
        },
        {
          endpoint: "drpc://XXX_MY_DRPC.ORG_API_KEY_XXX", // Add all supported chains of drpc.org
        },
        {
          endpoint: "blastapi://XXX_MY_BLASTAPI.IO_API_KEY_XXX", // Add all supported chains of blastapi.io
        },
        {
          endpoint: "alchemy://XXX_MY_ALCHEMY.COM_API_KEY_XXX", // Add all supported chains of alchemy.com
        },
        {
          endpoint: "envio://rpc.hypersync.xyz", // Add all supported methods and chains of envio.dev HyperRPC
        },
      ],
    },
  ],
});

```
</Tabs.Tab>
</Tabs>

### Full config example

To have more control over the configuration, you can use the example below.

<Tabs items={["yaml", "typescript"]}>
  <Tabs.Tab>
```yaml filename="erpc.yaml"
logLevel: warn
database:
  evmJsonRpcCache:
    driver: memory
    # driver: postgresql
    # postgresql:
    #   connectionUri: >-
    #     postgres://YOUR_USERNAME_HERE:YOUR_PASSWORD_HERE@your.postgres.hostname.here.com:5432/your_database_name
    #   table: rpc_cache
server:
  httpHostV4: 0.0.0.0
  httpPort: 4000
  maxTimeout: 50s
metrics:
  enabled: true
  hostV4: 0.0.0.0
  port: 4001
projects:
  - id: main
    networks:
      - architecture: evm
        evm:
          chainId: 1
        failsafe:
          timeout:
            duration: 30s
          retry:
            maxCount: 3
            delay: 500ms
            backoffMaxDelay: 10s
            backoffFactor: 0.3
            jitter: 500ms
          hedge:
            delay: 3000ms
            maxCount: 2
      - architecture: evm
        evm:
          chainId: 42161
        failsafe:
          timeout:
            duration: 30s
          retry:
            maxCount: 5
            delay: 500ms
            backoffMaxDelay: 10s
            backoffFactor: 0.3
            jitter: 200ms
          hedge:
            delay: 1000ms
            maxCount: 2
    upstreams:
      - id: alchemy-multi-chain-example-1
        endpoint: alchemy://XXXX_YOUR_ALCHEMY_API_KEY_HERE_XXXX
        rateLimitBudget: global
        failsafe:
          timeout:
            duration: 15s
          retry:
            maxCount: 2
            delay: 1000ms
            backoffMaxDelay: 10s
            backoffFactor: 0.3
            jitter: 500ms
      - id: infura-multi-chain-example-1
        endpoint: infura://${YOUR_INFURA_API_KEY}
        rateLimitBudget: default-budget
        failsafe:
          timeout:
            duration: 15s
          retry:
            maxCount: 2
            delay: 1000ms
            backoffMaxDelay: 10s
            backoffFactor: 0.3
      - id: blastapi-chain-42161
        type: evm
        endpoint: https://arbitrum-one.blastapi.io/xxxxxxx-xxxxxx-xxxxxxx
        rateLimitBudget: global-blast
        evm:
          chainId: 42161
        failsafe:
          timeout:
            duration: 15s
          retry:
            maxCount: 2
            delay: 1000ms
            backoffMaxDelay: 10s
            backoffFactor: 0.3
            jitter: 500ms
      - id: blastapi-chain-1
        type: evm
        endpoint: https://eth-mainnet.blastapi.io/xxxxxxx-xxxxxx-xxxxxxx
        rateLimitBudget: global-blast
        evm:
          chainId: 1
        failsafe:
          timeout:
            duration: 15s
          retry:
            maxCount: 2
            delay: 1000ms
            backoffMaxDelay: 10s
            backoffFactor: 0.3
            jitter: 500ms
      - id: quiknode-chain-42161
        type: evm
        endpoint: https://xxxxxx-xxxxxx.arbitrum-mainnet.quiknode.pro/xxxxxxxxxxxxxxxxxxxxxxxx/
        rateLimitBudget: global-quicknode
        evm:
          chainId: 42161
        failsafe:
          timeout:
            duration: 15s
          retry:
            maxCount: 2
            delay: 1000ms
            backoffMaxDelay: 10s
            backoffFactor: 0.3
            jitter: 500ms
      - id: infura-multi-chain-example-1
        endpoint: alchemy://XXXX_YOUR_ALCHEMY_API_KEY_HERE_XXXX
        rateLimitBudget: global
        failsafe:
          timeout:
            duration: 15s
          retry:
            maxCount: 2
            delay: 1000ms
            backoffMaxDelay: 10s
            backoffFactor: 0.3
            jitter: 500ms
rateLimiters:
  budgets:
    - id: default-budget
      rules:
        - method: '*'
          maxCount: 10000
          period: 1s
    - id: global-blast
      rules:
        - method: '*'
          maxCount: 1000
          period: 1s
    - id: global-quicknode
      rules:
        - method: '*'
          maxCount: 300
          period: 1s
```
</Tabs.Tab>
  <Tabs.Tab>
```ts filename="erpc.ts"
/**
 * Converted config in TypeScript. Copy and create erpc.ts so the binary automatically imports it.
 */
import { createConfig } from "@erpc-cloud/config";

export default createConfig({
  // Log level helps in debugging or error detection.
  logLevel: "warn",

  // Database configurations for caching, dynamic configs, rate limit persistence, etc.
  database: {
    evmJsonRpcCache: {
      driver: "memory",
      // Uncomment and configure below to use PostgreSQL instead of in-memory cache.
      // driver: "postgresql",
      // postgresql: {
      //   connectionUri:
      //     "postgres://YOUR_USERNAME_HERE:YOUR_PASSWORD_HERE@your.postgres.hostname.here.com:5432/your_database_name",
      //   table: "rpc_cache",
      // },
    },
  },

  // Main server configuration for eRPC to listen for requests.
  server: {
    httpHostV4: "0.0.0.0",
    httpPort: 4000,
    maxTimeout: "50s",
  },

  // Optional Prometheus metrics server.
  metrics: {
    enabled: true,
    hostV4: "0.0.0.0",
    port: 4001,
  },

  // Projects configuration.
  projects: [
    {
      id: "main",
      networks: [
        {
          architecture: "evm",
          evm: {
            chainId: 1,
          },
          failsafe: {
            timeout: {
              duration: "30s",
            },
            retry: {
              maxCount: 3,
              delay: "500ms",
              backoffMaxDelay: "10s",
              backoffFactor: 0.3,
              jitter: "500ms",
            },
            hedge: {
              delay: "3000ms",
              maxCount: 2,
            },
          },
        },
        {
          architecture: "evm",
          evm: {
            chainId: 42161,
          },
          failsafe: {
            timeout: {
              duration: "30s",
            },
            retry: {
              maxCount: 5,
              delay: "500ms",
              backoffMaxDelay: "10s",
              backoffFactor: 0.3,
              jitter: "200ms",
            },
            hedge: {
              delay: "1000ms",
              maxCount: 2,
            },
          },
        },
      ],
      upstreams: [
        {
          id: "alchemy-multi-chain-example-1",
          endpoint: "alchemy://XXXX_YOUR_ALCHEMY_API_KEY_HERE_XXXX",
          rateLimitBudget: "global",
          failsafe: {
            timeout: {
              duration: "15s",
            },
            retry: {
              maxCount: 2,
              delay: "1000ms",
              backoffMaxDelay: "10s",
              backoffFactor: 0.3,
              jitter: "500ms",
            },
          },
        },
        {
          id: "infura-multi-chain-example-1",
          endpoint: "infura://${YOUR_INFURA_API_KEY}",
          rateLimitBudget: "default-budget",
          failsafe: {
            timeout: {
              duration: "15s",
            },
            retry: {
              maxCount: 2,
              delay: "1000ms",
              backoffMaxDelay: "10s",
              backoffFactor: 0.3,
              // Note: Jitter is not specified in the original YAML for this upstream.
            },
          },
        },
        {
          id: "blastapi-chain-42161",
          type: "evm",
          endpoint: "https://arbitrum-one.blastapi.io/xxxxxxx-xxxxxx-xxxxxxx",
          rateLimitBudget: "global-blast",
          evm: {
            chainId: 42161,
          },
          failsafe: {
            timeout: {
              duration: "15s",
            },
            retry: {
              maxCount: 2,
              delay: "1000ms",
              backoffMaxDelay: "10s",
              backoffFactor: 0.3,
              jitter: "500ms",
            },
          },
        },
        {
          id: "blastapi-chain-1",
          type: "evm",
          endpoint: "https://eth-mainnet.blastapi.io/xxxxxxx-xxxxxx-xxxxxxx",
          rateLimitBudget: "global-blast",
          evm: {
            chainId: 1,
          },
          failsafe: {
            timeout: {
              duration: "15s",
            },
            retry: {
              maxCount: 2,
              delay: "1000ms",
              backoffMaxDelay: "10s",
              backoffFactor: 0.3,
              jitter: "500ms",
            },
          },
        },
        {
          id: "quiknode-chain-42161",
          type: "evm",
          endpoint:
            "https://xxxxxx-xxxxxx.arbitrum-mainnet.quiknode.pro/xxxxxxxxxxxxxxxxxxxxxxxx/",
          rateLimitBudget: "global-quicknode",
          evm: {
            chainId: 42161,
          },
          failsafe: {
            timeout: {
              duration: "15s",
            },
            retry: {
              maxCount: 2,
              delay: "1000ms",
              backoffMaxDelay: "10s",
              backoffFactor: 0.3,
              jitter: "500ms",
            },
          },
        },
        {
          id: "infura-multi-chain-example-1",
          endpoint: "alchemy://XXXX_YOUR_ALCHEMY_API_KEY_HERE_XXXX",
          rateLimitBudget: "global",
          failsafe: {
            timeout: {
              duration: "15s",
            },
            retry: {
              maxCount: 2,
              delay: "1000ms",
              backoffMaxDelay: "10s",
              backoffFactor: 0.3,
              jitter: "500ms",
            },
          },
        },
      ],
    },
  ],

  // Rate limiter configurations.
  rateLimiters: {
    budgets: [
      {
        id: "default-budget",
        rules: [
          {
            method: "*",
            maxCount: 10000,
            period: "1s",
          },
        ],
      },
      {
        id: "global-blast",
        rules: [
          {
            method: "*",
            maxCount: 1000,
            period: "1s",
          },
        ],
      },
      {
        id: "global-quicknode",
        rules: [
          {
            method: "*",
            maxCount: 300,
            period: "1s",
          },
        ],
      },
    ],
  },
});

```
</Tabs.Tab>
</Tabs>

#### Roadmap

On some doc pages we like to share our ideas for related future implementations, feel free to open a PR if you're up for a challenge:

<br />
- [ ] Support a Typescript-based config to allow injecting env variables
and code reusability.
