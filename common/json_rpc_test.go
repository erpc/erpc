package common

import (
	"bytes"
	"encoding/json"
	"fmt"
	"reflect"
	"runtime"
	"sort"
	"testing"
	"time"

	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/require"
)

const ethGetBlockByNumberResponseCanonicalHash = "4a82e6c4405d503341a29be98938ad628aed014c7cdbdd7a83a85be55ff49a0f"
const ethGetBlockByNumberResponse string = `{"id":1,"jsonrpc":"2.0","result":{"baseFeePerGas":"0x137d0bb9e","blobGasUsed":"0xa0000","difficulty":"0x0","excessBlobGas":"0x60000","extraData":"0x626573752032352e352d646576656c6f702d62386364346338","gasLimit":"0x390d860","gasUsed":"0x15cfc87","hash":"0xe27565f06f04fe79d3c3bb4dc9749a0318c520d7f784545be4d1a65bbcac21db","logsBloom":"0xae206c5f8adfa784b2aca218aa9c9eb470f714451e08f0efe0ea2406359615c3839abc07ba5e3c1a0102168b1d2fb858c132376084e6dc04fe42be6624ec249b0a9ab88485a2f52cc4297ccf7f23fb3885596b5464562ce84b9b2955e1a080917d0032833bed3c4101a89c4bf3434d4e16411fc0c0244f497386dc3c11f583cce2d58635f73ac75464c840a7e75cf03df174a649f08caf4e9a153188fe862cdac6d82bd22fc5358b5fe624e65be4028848a2f40aa2abb89a391e930a616d08adfc5960b209c1658a0b1f60f1fc63a0b41857c91488e50a6b00031de20948eae7cc1abf18c99da0cb678d791b987a6e1ce8268b34c432564853b6a52128726e06","miner":"0x3826539cbd8d68dcf119e80b994557b4278cec9f","mixHash":"0x807bee076a500d33eb547cdcf948808b473a8ed44f6227b56647f64719340b94","nonce":"0x0000000000000000","number":"0x7f04f1","parentBeaconBlockRoot":"0xc0959914345b1f080a0659d7ff38cc1a9992caf800b62de6b2dd5b548f072984","parentHash":"0xf60f120fe84500833ef563123067a765361a7af59a11e3370971c1136e28540d","receiptsRoot":"0x6c3c22526eaf8eb9e177d60e7aee4f546e79527468fd294d1fde9f1e3bcc17ee","requestsHash":"0xe3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","sha3Uncles":"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347","size":"0x1faa2","stateRoot":"0xb40115a391949e36c4cf558d93686537360cd9c4193fb2c0932a4812c340437f","timestamp":"0x68246b68","transactions":["0xdb56e3aea5cf9dde901471cf8b001de8f21246a9ee529e7f084af6919619fdcb","0x8f2c922d06201010b7b46559c500f265cd4d9eb1920a548365ac8a956d8409fe","0xee944d33a8752f1a876923b8700492063a4411a7782c3df9dd4ad56fb9435378","0x885c866d7bc505ee9a0cfbe9165af3d510bf086066966c6729fcf63d52d9a706","0x92ba2406dd1882cf7665a75db8fb8cd9afd5c35c6a1c7137d8c5972ec11cd518","0x4450d950d3f39c524f0e55d2688a8f7bdff1e0a3492794f7366fc10dafe9b4b8","0x779bf6a493fdbb24a98eec24b76da47ae1ba78e9b2538fb1506d3a6c1c04c3aa","0x4b46652b04772358c4adb0492229be79f682ff441de3c02d602ebccec0bed4db","0x236569d781f2fa3febab246b3544d0ef0ec6806957b5d9ffd711495b1c046af3","0x94c767fd666e1483586e1c5f7f1d70445f00259f8d265aa69aab7bd8fae586ac","0xa12e17c3c30e9da2f2d945320fcef96963b5e9c2114f8e5752d8d3dc73ce9465","0x3814ad1798feaae15c6581c652f568a8fe205f37e57bfa2b2027462a7c300462","0x65736ceea08c755a9be88c2a2f2048073ea682024c028ebf98fe1b62ec0092d3","0xdb2e881803d7c1fe8ee9f9e0c4070fe4a8e890df18055031e6b8e42112f8bab7","0x9290ecbbd1d75fdd8ceed988726a76d051b27dcc1324949e73249b565b29a2ef","0xadedb91f015c26f262c2bb2e54ea8bac73f7946300679fd3fe71b7050b8609df","0xe5066c234e3f5e058bff071e46d507c51d768f81e6536b05ee52a849664ea8bb","0x9516a3541cd5d3ba33b9aa1cc609bf6588ae2c173dc3a7f3797ee2ea13157c9f","0xc4b8ddb2d6d74a287563f0f9399e49fd701bf78db92666ce61c333a6c9b17c01","0xf01957eb84ca84f5b3004961d2e444c6a8314d22b084e9432d4e44dcfbae0671","0x417023f2db9ec41cfc8e3269bf5bf1258e8718328d38e88a82653ad6f4896c18","0xbc5743e4d83fd7526090ecaf3a522b24f7714bcd7aa2b333bdcfd1e05e20e1a5","0x6fedb150e2ccde5b7ca6e014f7060618a2b5b247751a95ee3506566aa0e7b987","0x1cde2f8a58a1302631d0a49f6e669dc56f147c628d9ab6a4267db89e8faddc45","0xc7c8c30164538957b8b7364557b6b68f5b6a1a2ab13569f264ec551b6bcc6ada","0x5f7bae42f4a518bf97481dea734d6953e546c179de1e29b606d5f2e40b11f0f0","0x4e96aa9e96c1f02aa7aa6ffceb46d0ec6d87cef86b8e393484ec8ece8b939026","0x3c58dd0158e2331a1dd9ef35cad9e1d4193f3ae740b9fed4d8c3258001efe931","0x312b82669e8b9a4f370b1273731e2e876008c229c2a5d70125cdab56c6a3ca43","0xe0175af9099a50f6490ab1ccba436807513cc3149ffbd81099f95dd17938e986","0x03ad5884b07357819a75a1916835a55e3e4248e80633f2bba7c038c3d3d7321e","0x31e8d9958b5e9b0c6e6abeb7bb399c5f6f22d914ac444959c41e0826b19e9e48","0xaed135c2b75c9f318e4de50c5c52490679814ff9247744c4eafcb7c30b87578e","0x9aac3a785af0908df8b6ec02836e2e00cc239d4a6390858ef226d1661a6c3bbf","0x12983397ab2c960bc5172237bf158334dd8f5e70791558455d53b50ac8ccd054","0x9002aad3456ea9e74fba2df17508672837b3c5c74cdf5217d0e1f3052b8bb1c7","0x79ef661a091de86c2c89ac8809e9ef76e482d8ce67e9a9ca098fd43ebcb269ad","0x4182bfd984940ef27717e9e5ac8cddd0dd9e873e1b15046c240cca2270445930","0x98e1f18b6a6205abbcda5c0917bf37ee220ed687380ac2bd566fa5fa078fa366","0x5a08bc76faa52b6c3756399a6aac213dc3427803cb244ca9f9650656f3b0f077","0xf3b5cc38c59d4daf18ce0a883749356bb76a52a8435ac7fb214d626ac91fb2cc","0x3e049ee3937d31fb68d8c4c46df745170c1a1d6e7fd40fd96876f864271b6c18","0x2182047a081573d2ecb7db0d048e08c659e551fb5d448bc0dc776d06b4051b8c","0xeeea7ffd972df73fe615466ab3a1292f2cb7c2baa89bdf16465a53f289952ad6","0x011e9d99d469bc6f08d7335f3900b0cd63b347d4c54b5b3c3842231dcaf43ed4","0xa0b2400b916593bdc1e788573e8f6163e0bb548b774b94e17694cf076433744f","0x843566978bc22069b02b3085914629b80cd985cde96d6831da916194f1063eb5","0x36ed34068fd58a595e9b69e1fc8c99a802abc1db0224c785df6a47fb820cf323","0x53e8dc4b99bef5b3e3fb886ed21eabd9892c53141d3eb4148d8face1882be717","0x41de939a219c7c475859275706d9c117dd05297d0e7f1d3ca7ac06e8c86228d2","0xea1507bb2a5296fe80604f6af0de6e4fb85b8802036b0fa1eb3931b8cc86095b","0x85c1e1c1ce4950b9f0e28b350c533a2c4773ecd176528c9ae2263eb05818e5b1","0x5244c80428c4efae855096b367eda78d1a1baf6536b6300299c00508c986cca9","0x520daddccf1a3dee4f51d070b3fa1f44382641c70236f0282d1d5b7d12eed1e2","0x716f0b08e1c4902a58553ee2878555f943fb0fb4dfeaaa08257d793551f61180","0x8a1ef5eb1664a1bce4d68c7a42e7346e918b4f074c9a36b876835a735994918c","0x2b863f6c4fd7f1200d7555744d0d5c521a752fde9cfd9ef1c3c3f8f0147f5b9b","0x6eb25b54afe54cfca47ce95132e05ccbdf49b1c77331410020c2812eb2dcb0ab","0x0c2999674a652af5cd8824c37d1aa9c8d1e71389a992d3a13af66a19a6011e42","0x3d473047315e5659fb5f6173cc0b16d871c1145aa37115291ed3fe927af3b182","0xaea5d89f663d2e457cb32346a21e2ebd7c2129ac8012439cd3cd1f607e5cf9a9","0xa81eb6a5de075be70f536d9225bab4bb2d62b4f265c76a5881b3149828b7968a","0xa4d64bf04afa6ec1056207b798654e215117f8692ce5105c24813b6f07fde04a","0xf7c1bae79b7fa53a129acbdc1ced2507dbaa5586905ca6c7ec2459571a8715d6","0xa06170308265605f7a37f121e55e06d93d9f0fac2bb0055164cfdc1a39529b73","0x72d94084fb10100358d9b3bdb7f653b150ee1fbef927f806510c23e9844015fc","0xa045b77546cba15199906cec02a792d7a3f3c59e61ebf45f4cc3320f6d5f9e00","0xa76e94a5cc76f3a8b3d076c96fc6d3b9b4603401b25cb02187155e7a872ecf8c","0xaa8b910ad1eed2c581fd8a7ecb94d8197dfced31c7e801f2e0ffcddd621616e6","0xef0b9f34b95d684db90ea1848208557ca5cff3e5d10f7a93990199272c07c59b","0x3b47987e4fb2565733b282bd7d63e0efb7a5343b11f395544cffcdd0249770ba","0x4404c7bd9e2e820eebb8d2847cbde8bff1e80c1b4298f1623bc92d615319596a","0x547d4c3eb5af83726278a7355b5e6d99693a2b1e8fe784568d7cbf17e48fedbb","0x60ba7d53e7ffbce9e297968cbab09cbbad721554a50019b3876147732f5236fe","0x3882b203c2752afa69763b694f23425830436da26eef92374e4dfa2a31d0bf74","0x9c822cb1b6549a91154eb532ec7e8b19e34ef87fe0ef2384cc48312a49998991","0xfb06a0060480c1bc1caad38c2864f719949e98caa0d8c709fd7485387ace99fb","0x83985f38227c7fe6c96daa21ae6b528a83a239d1c615978aa6fb3c202db8cd6c","0xeea137c88ffbcd7446fb85bcd1ea83d2ee7a99ef28fe1d063492785654c90a92","0xdf02e6afd09bf0d4f859dd65f8867a1d82354e057d7f62375070d5e2a3005b46","0xb55403e8dc95dc3917677667a4e078875aad63618ba6f36b2947d9ad58a59cac","0xa7b0e71f277c828348b3e5ffd4ca7f48e671d3cfae0eabacc1cb96ce8561f4d1","0x6727bfe6db3b3d594c4026d886651e93706f46812ba2eda36751e171b919ec7f","0xaa8c88b0eb0c3e1c1862413c4d7b8f8b616c75f796f0e664fa940b17b0f95573","0xb487cdecfcf254d8e90863765f8814e683f41152d7376bd8364b07d0ffd4a99d","0x322d7393fa20cec2b0d8f81c04dc23526b98e3f79f2c9c0bd5e5302812e9b4ec","0x1a1b0698a9158528757e20cb35839fecd0333e9c0a1e059765a4194506e96d35","0x48de79c241cc9a040bbe158329a28878cd315848dd71db26808ed63b2bcb3680","0x77b9443e53d18c29ddd8369e7c9aeecfb3ccbcd20b64fb8b0ef33d859f8ac5a7","0x664f507473dc1fa7febc6882cbca7b8b62d8b35b66fd793b65c1ca5ca5ab461a","0xaa7f59758605cb7457de9f50f4c41619ead822a16fe4857bd68b7af4690fc6d8","0xc309d36c7b67cb98a3d181f969981f1345a65b1c5dc3b57c50ad89067b665537","0xc951f9a8f933fdb8ae458be757832b7e5e86db50b4d31e1b54b2964ce71a171d","0xf28699295da6055d2a66fd64aac4736cae0868ba655bd27fee5298ed69380565","0xe957fdfc729ea92e52f63399264d1a6a2bc95caed1cd4c22e5ac0fffc304c3a1","0x0c488615d4f382d07d6e83e66884ac0435d95b7f9fa270481164629e470bd06b","0x88350a85fa1db68aba9ce5de124998bb9788fa8a43b561f2114edc1f611bb154","0x1f2edb57b469b9a12befe7b69f15cbb8ec8478ff3ec1dce0eb9f60e23ea3e3d3","0x1c135c7cd43ee6e00918e26c0775b556a563c3ae1f797b40964631088172f231","0xbb7c4ce1d9b3d9f1e5e3310a59d14044bd2f7d961aabb2801ff512256e3c5414","0xa920845ab1189bdf8883566d796d4b8f129872b852eaf0d32e08ec4e2bdc3bf2","0xb4f4d7fdf31a7cc956233205fac47f0105cd9ec364e568c9e8c7a8ce0e0d93ad","0x8f01da42338fe0b985fadbd916d7916cb70b9e729c26d78fda9157bec22f9445","0xa53a23d283ab81e21ed85b716a6b8e57cec50f6355f2d01724237f48faeedd25","0x0bb34f8f39d71a0b0c5e7397268fa751535c39377990106505f0a73ed5a831e3","0xc3a66016713445932f5593a73c0f327575fa5a546e60d93aeac533883d1f613a","0xb9e7fd674027e879301a3b4efe9f6fb8991d7c2a81c7d147ca382c52fd4d3a8a","0xcca297c22265202d2f0fff0f0e92895a0c9d4404adb6460097d5bd7ca2b2da68","0x48bbbc2807b582ae0fb24022048f3888a27a2f903fca85c6e869bdc518f40627","0x1a156d56dace005f5cbd206c49fa0bc2da80c597040d1c256ce6063f25200ba6","0x1b501d91031c2d442863e54cd1378098a3b93501b85ca67c9b861ef4dcd34646","0xd227a90a3b0c195d2d5b3d087e8584f4c21d352cfcde97a425ad70f6e1628e6b","0x355b9ac70cb58c870fb6de3677b075d108955e402af27b01b6785f97f7955349","0x7334cf5c2363d9a036cc34936665f1b41bb4d39e08c11a4f024849bdc1627ffc","0xe5734bd4bcbddc4653dbb0e94717995543c6d0fc29c9a1f354ec80b96fafc97b","0x95eb999666891a6fec5a0371fc80bfc72809d861f06ff6eec510c25cac4ec184","0xfed874d24fc60f5e5e86183480c868befab5a6cab497a09819930962639c6981","0x812e384384f4d59c887c577dea90bfe3d3556cd9ac0f0eb1696ea810a122b798","0x8de152c5c5002c9061a0b50ecf473effbf43a3bf107c5b837f5b0408d1f1a92b","0x1c8c56104fe9f9deb22b1db30c950e4bebddedf4eb7f7ee3ddcbbb075c8698b2","0xf489d85a1fd68dc3026c0de1031258d9d5a8e605213d55dadb347a4f55b969af","0x06883fb3bc34e71c4cda44bc1c8fdb26473ae6f3e4ec6924e1d8e5d3591489ac","0x017445e287658263720c4ff1408fa1dbdc37790bfb638e0d503dc00c57f2def1","0x3b79f3ab3ee9b73f529ab94f473068862a3a61a0cb42011e702df96fa5dcb8b8","0x2bd8ce6c706b81536091fc7fc395a3021970e520d741b5913c1ff1c69237996e","0x14242652adf68c3543805c7d8ffe95759d0a8ee17897804ed6dc8e72a3e13c1b","0xa52ee7cde89443e378e371dfb7fcebae73ea9af1209027620d4e3b436a50785f","0xc5b95722d50022cbf31880aa1cd0548fb1dd87273fbdbe2490a6c9d1043d246c","0x6eb2b5d62d7e0abfff52972e90cc9c8f74083003f5091c93d4cdc85b0b574932","0x97102dd54c9d256a6270bd58f1b4e4da9d2e2ce1d5f61e48a6b2077e04ac340b","0x324e8f7f4a05676a4be725379883cc1cfc5c29c629680c49d781af79d16f1cce","0x909c6b96dd6697613ad5c4be61f46e796d04740ef52b090f47bdbbe827e0d3d3","0xff0786c6fea3646110af4fcc67f022532e4064105537e63c662d5f0c0f73f8f0","0x798a18344025131c5cf1c46c9486160eea3b4f04c6053ec6d8baea55540a00fd","0x46318f660edd0cd0d0ff040d9e9c2eb6add3c9fad1b2f2a355aebca7174be9ec","0xe43df3ce42dd236b739f8ad281c023492cc5668b35e0e8e67b7452f0f70db54f","0x89dae5ca0688e83f2e9ed25bbe2731e88cf7ca2366771687b612d13b77667c88","0x9df73f0ca943ea961f9b121930000a80136602fb214fd8f579f6715e14150a2c","0xe9ed5a0f004d2d0878a29934d885045c4db1598bb16662913dde3366c72d9f0d","0x85445d6b965b771cf3854122091050653f902d64ccc0d2b6640e975cff8ff2eb","0x6c51f44ebeabdc4874d477311ee3485cb7ea4b060f18b92aa234b504283450fb","0xfbc4669c31d2708f2ff9d2ff3fcef8653ab78ba07bdd63a4255d09311048a716","0x9521a8749ea043736e1e9debd9518063959087eeaa67a95f81c7c7b41dd3bf0f","0xb619b47fac4b47a7c1d1ba27b3036d6a204a2b7b86ebdaccd24d1624f2c0bfb2","0x76f611bb6b2ab74677072930b8a395c5a77a151d8192a34ee82d4a242deb7c4f","0x23543a5f506493ace38933bcc6f5e0ee5348135067a80da6e61c0355b029b99e","0x85d609254d2c457b0e636de9ad3db68c66c5281ac557e58bccf6064468ab4148","0x427f4d6d9b957b94765abf9af80799378a1982742ffddcbf1bdd51fa24af5889","0xd13a146560492ef349a2e05260cbdec6281e607394fd6fc1799f35648944b16f","0x5c580ad50cd82179e52eafa85b5aec033dbb1ee9a7e2f931e17d06f653b571ee","0xae6f62dced857f2afabf446eef65e736ace3550d5ddedbcc5548be3b6341e8bd","0xd801f1d7549ae30b8caa5e2323bfa1aa07a7bf5a72a3a8da602d8d910637c671","0x16120db3c2689a9b170851698420549d4b79343d975fc5ae5ee8c3cdbf61313b","0xba2987afe3aba028f87ee529e552f1bd157e2b20dfed42e45f3a091d40ae3532","0x995294f1eb392f5ef52229cabd17620d03d8777c5c3d6075de60e1a10ce3bfd0","0x33555c44458ea7555e0f62fba8ce108a8dd8f17adaa3bee34abed143e53046fe","0xfad77c9178fb1fe0718cff0c273f2f45725253825ad9b6879bd85496aa2d308b","0x93893dc15d28b47099c453a747ca6350f3dc2f916aa9b595168bfad0f72fe4ab","0x1716a19dea0b8990f79ae2b4a90e0ecccd113e83fa0e2451eb4a8d6dced03750","0x1e6e290064b36fe35327f7da65038f32aeb5b2e52671fd9fd5757b7b73558e77","0x5ddfedf48618a35693551336ad80eabe43e3b1250b0be0c5eb60163e72de32af","0xb2b0fd41070221a2f87cb58646359b86391308c9350fb84ac829cc71edc5202c","0x81823bf7bd1ddb147f310a42f93ae1e46a8e63a22de4041519c6912754500c1f","0x0c0246e0f5238075af0d1415582ffdb29feb08527465d63adf7173d50ff021e4","0x874ad1d3a838e87ce91d0ad38bff0f9a5e91010fa0ab9a6f1c370db12db4ff63","0x8147a446c3e55a69a9b1309bfc3558e04f9f7708d4ef2e53db38d5d63fdf8985","0x10bcdc3d37fd7f9ef29145281dd6e10f45eb3edc37b959c7ce246c09b3b2b6ac"],"transactionsRoot":"0x7302699e65a901d688e8a0f06aeb1bf7aeed7445c27e70e4205da9c90b5a7edd","uncles":[],"withdrawals":[{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x38e71","index":"0x515d3ad","validatorIndex":"0x19b"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x342cf","index":"0x515d3ae","validatorIndex":"0x19c"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x342cf","index":"0x515d3af","validatorIndex":"0x19d"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x38e71","index":"0x515d3b0","validatorIndex":"0x19e"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x342cf","index":"0x515d3b1","validatorIndex":"0x19f"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x3da13","index":"0x515d3b2","validatorIndex":"0x1a0"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x9010","index":"0x515d3b3","validatorIndex":"0x1a4"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x4808","index":"0x515d3b4","validatorIndex":"0x1a6"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x4808","index":"0x515d3b5","validatorIndex":"0x1ab"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x4808","index":"0x515d3b6","validatorIndex":"0x1ad"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x446e","index":"0x515d3b7","validatorIndex":"0x1b4"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x88dc","index":"0x515d3b8","validatorIndex":"0x1bb"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x446e","index":"0x515d3b9","validatorIndex":"0x1bd"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x88dc","index":"0x515d3ba","validatorIndex":"0x1c0"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x81a8","index":"0x515d3bb","validatorIndex":"0x1cf"},{"address":"0x25c4a76e7d118705e7ea2e9b7d8c59930d8acd3b","amount":"0x3d3a","index":"0x515d3bc","validatorIndex":"0x1d6"}],"withdrawalsRoot":"0xba38ea1816871bfbd95cccc97160a762b06d9a654135477ea832662eb6748acd"}}`
const ethGetLogsResponseCanonicalHash = "ad982e1ca9cf7f51c3820fb848a91ed14b4d8c2a3a93a54828a84ec709561ceb"
const ethGetLogsResponse string = `{"jsonrpc":"2.0","id":1,"result":[{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000056eddb7aa87536c09ccc2793473599fd21a8b17f","0x000000000000000000000000e291cc3e5b9e0c9b37c9fbdd549abf3b5c0ad342"],"data":"0x0000000000000000000000000000000000000000000000000000000ba42490a0","blockNumber":"0x15536ea","transactionHash":"0x9ebd9461d1973d565c0a53c054e3eb058b1b2a14d0982cea11db488b455a7dab","transactionIndex":"0x11","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x2b","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000006240b5dd984285ead016030c734f709131d18d36","0x0000000000000000000000002552a7660a03b35f05af5bc8c0173794dfb19886"],"data":"0x0000000000000000000000000000000000000000000000000000000006567026","blockNumber":"0x15536ea","transactionHash":"0x4b89ba745b492f58f13a61e4439d737d4aa9148b2e724c00e662bac084a08218","transactionIndex":"0x16","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x2c","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000dfd5293d8e347dfe59e90efd55b2956a1343963d","0x00000000000000000000000089f11e5d209fa14e4c3a32d1c6415a277b2efd02"],"data":"0x00000000000000000000000000000000000000000000000000000000030291a0","blockNumber":"0x15536ea","transactionHash":"0xfb5ddb6a645715d2ce34e02db73ca26cf996a61501fca847a0ab382da8cea1af","transactionIndex":"0x1e","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x31","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000021a31ee1afc51d94c2efccaa2092ad1028285549","0x0000000000000000000000006cda56673c4d3c6fe21b787d4e5abbc209519c4c"],"data":"0x0000000000000000000000000000000000000000000000000000000005defda0","blockNumber":"0x15536ea","transactionHash":"0x86a5bd78d3dc4fd44a343a32442ba6a360c898854760992b5f07a910c61662b4","transactionIndex":"0x20","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x32","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000fca00b1d6dc6576bfd59dcf4f22b24c818dd1301","0x000000000000000000000000489d525e7ce5aa55cde521e1f84fb5890ca5e883"],"data":"0x0000000000000000000000000000000000000000000000000000000039292dc0","blockNumber":"0x15536ea","transactionHash":"0xa64f0d2f1e1cd97283afee7eb8c835ffc4afe6ba84acec36409765b006ffe055","transactionIndex":"0x22","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x3a","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000b82fe5b9b05bc4196a7a572cde5f35fd21f97f15","0x0000000000000000000000008c97231a9def78c633be883b3d1886e1408552e1"],"data":"0x000000000000000000000000000000000000000000000000000000000660b0c0","blockNumber":"0x15536ea","transactionHash":"0xb10188a77865c27a98605bf94f5dd7ee45bde0dfa94f33c0e0d1dc385ea42830","transactionIndex":"0x23","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x3b","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000046340b20830761efd32832a74d7169b29feb9758","0x000000000000000000000000e2803bc1099eeab4322476bcc38f12ead6d4a98e"],"data":"0x00000000000000000000000000000000000000000000000000000000052c2bde","blockNumber":"0x15536ea","transactionHash":"0x69431068335b06024270e8fd1b01e3059c75ab6f43e2e7eef1babfef87c766d3","transactionIndex":"0x26","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x49","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000a551e70a4374e9369a89f5888a04cc6ac73706d1","0x0000000000000000000000000e9ff1524e75d53cb16a68cadbd8a96f0e172d5a"],"data":"0x0000000000000000000000000000000000000000000000000000000077359400","blockNumber":"0x15536ea","transactionHash":"0x6b51b8a9021b1a70746a942fb44292d113f43ce7e86639e0818cb2eb0dfa7a1b","transactionIndex":"0x3b","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x6e","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000cf24d8a93c9277b4a15f057d65e8bd91733f12e0","0x0000000000000000000000009008d19f58aabd9ed0d60971565aa8510560ab41"],"data":"0x000000000000000000000000000000000000000000000000000000000ac258ba","blockNumber":"0x15536ea","transactionHash":"0x2fb1c780ae676fcd034f19e52f8234636e43ba12da4030d914bd9232bc48ca23","transactionIndex":"0x3c","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x85","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000009008d19f58aabd9ed0d60971565aa8510560ab41","0x000000000000000000000000e08da0d972b74581ec77a3c988e47d6e56bfbb7d"],"data":"0x000000000000000000000000000000000000000000000000000000000b176785","blockNumber":"0x15536ea","transactionHash":"0x2fb1c780ae676fcd034f19e52f8234636e43ba12da4030d914bd9232bc48ca23","transactionIndex":"0x3c","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x89","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000009a1187cb7084f3e60a8b99eb195d9f3c29361a8a","0x0000000000000000000000008dca941474e2f9378157fec599d02025dd87eb09"],"data":"0x0000000000000000000000000000000000000000000000000000000000b71b00","blockNumber":"0x15536ea","transactionHash":"0x0623d92fdafc0b9c60dffb66366f9fdbb072a593a9a5fddc081ccfad3a92a629","transactionIndex":"0x3e","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x8d","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000006c08f16eca3bde3df6dad9c8ecd836198a72560","0x000000000000000000000000a0bb1ebf52a9307f30509d3b385754c33b7f2e26"],"data":"0x000000000000000000000000000000000000000000000000000000021986cfc0","blockNumber":"0x15536ea","transactionHash":"0x281325c411cd42c3a53439412d75acfcfd10625121aaabcac0230049a41f83a6","transactionIndex":"0x40","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x8f","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000092e6f7ad96f939b3cccb416dc32d621e73efd9c0","0x0000000000000000000000009866b529c14ac1289a5c1682d400bdea0906a6e8"],"data":"0x000000000000000000000000000000000000000000000000000000083ffd1282","blockNumber":"0x15536ea","transactionHash":"0x7adc0503f808e9a2a874cd1801702d9743133013df40c5b12886b0311d059d4b","transactionIndex":"0x46","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x94","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000000000000004444c5dc75cb358380d2e3de08a90","0x0000000000000000000000000f4a1d7fdf4890be35e71f3e0bbc4a0ec377eca3"],"data":"0x000000000000000000000000000000000000000000000000000000007798eafc","blockNumber":"0x15536ea","transactionHash":"0xb85e8e8127968d490c33c781bb0c28846e6e85ca2f60bf7feab7e6407899cf92","transactionIndex":"0x49","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0xa7","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000f4a1d7fdf4890be35e71f3e0bbc4a0ec377eca3","0x000000000000000000000000e0e0e08a6a4b9dc7bd67bcb7aade5cf48157d444"],"data":"0x000000000000000000000000000000000000000000000000000000007798eafc","blockNumber":"0x15536ea","transactionHash":"0xb85e8e8127968d490c33c781bb0c28846e6e85ca2f60bf7feab7e6407899cf92","transactionIndex":"0x49","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0xab","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000c7bbec68d12a0d1830360f8ec58fa599ba1b0e9b","0x0000000000000000000000000f4a1d7fdf4890be35e71f3e0bbc4a0ec377eca3"],"data":"0x0000000000000000000000000000000000000000000000000000000077916f48","blockNumber":"0x15536ea","transactionHash":"0xb85e8e8127968d490c33c781bb0c28846e6e85ca2f60bf7feab7e6407899cf92","transactionIndex":"0x49","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0xad","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000000f4a1d7fdf4890be35e71f3e0bbc4a0ec377eca3","0x000000000000000000000000e0e0e08a6a4b9dc7bd67bcb7aade5cf48157d444"],"data":"0x0000000000000000000000000000000000000000000000000000000077916f48","blockNumber":"0x15536ea","transactionHash":"0xb85e8e8127968d490c33c781bb0c28846e6e85ca2f60bf7feab7e6407899cf92","transactionIndex":"0x49","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0xb3","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000005bcbdfb6cc624b959c39a2d16110d1f2d9204f72","0x000000000000000000000000f20d84e89291bd2b117d04e43b05c1a3aa3652e8"],"data":"0x000000000000000000000000000000000000000000000000000000000444a5f8","blockNumber":"0x15536ea","transactionHash":"0xc51bc897553e28cef0a517c92e4ede9bdd9485e0dc9889692fc68eee762fd90c","transactionIndex":"0x4d","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0xe1","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000003ed41b1f9b6263d37f6164f457fcee5a3462a113","0x000000000000000000000000797bda0f9ed32cf3c0c5c2ea7ead603c60fe61b4"],"data":"0x000000000000000000000000000000000000000000000000000000003b9aca00","blockNumber":"0x15536ea","transactionHash":"0x4268f7591d237390120d787926169d6c85829c86dbec65bb0d3c7518907f5961","transactionIndex":"0x4e","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0xe2","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000000000000004444c5dc75cb358380d2e3de08a90","0x00000000000000000000000081463b0f960f247f704377661ec81c1fd65b5128"],"data":"0x0000000000000000000000000000000000000000000000000000000004d363a7","blockNumber":"0x15536ea","transactionHash":"0x17a9334180e2ee37d253412337a6474779921988b86a1bd6321332c30c9811da","transactionIndex":"0x52","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0xf0","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000081463b0f960f247f704377661ec81c1fd65b5128","0x000000000000000000000000cf24d8a93c9277b4a15f057d65e8bd91733f12e0"],"data":"0x0000000000000000000000000000000000000000000000000000000004d363a7","blockNumber":"0x15536ea","transactionHash":"0x17a9334180e2ee37d253412337a6474779921988b86a1bd6321332c30c9811da","transactionIndex":"0x52","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0xf1","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000005ba52d7300719aa4eea45acefcf292b3f339c428","0x000000000000000000000000120358307d278981369067222d0457056cd23d00"],"data":"0x000000000000000000000000000000000000000000000000000000000fdcb620","blockNumber":"0x15536ea","transactionHash":"0x6def7e4250847f73e89115a256612392c672d097be26ceaa6ade2c8246fd036f","transactionIndex":"0x5a","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x103","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000006716b8abe28542003fe7d734a54c2f016738b468","0x000000000000000000000000cae0512aac47804e3905a51f0337fdcdb74e96e1"],"data":"0x000000000000000000000000000000000000000000000000000000000001868b","blockNumber":"0x15536ea","transactionHash":"0x126923fbe6b97fd68466dc429d282c1b81cb68ccfa6707b267d567f99b698c20","transactionIndex":"0x68","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x118","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000002095667cd70028d5d30c94897310271ec6a44beb","0x0000000000000000000000000e47c3a84c924a7fc4e22b76c1ab7ec7f32892b4"],"data":"0x0000000000000000000000000000000000000000000000000000000000002711","blockNumber":"0x15536ea","transactionHash":"0xc22c9bbc305788b819411de13606cc9d98d39de1feb3b22e2729696f8a115ffe","transactionIndex":"0x69","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x119","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x0000000000000000000000006aba0315493b7e6989041c91181337b662fb1b90","0x000000000000000000000000b300000b72deaeb607a12d5f54773d1c19c7028d"],"data":"0x00000000000000000000000000000000000000000000000000000000024d3aea","blockNumber":"0x15536ea","transactionHash":"0x7cdd1250b267311c73210429aa6aa1cf24446cf22521a6bb591d1d61b0e1e2d8","transactionIndex":"0x72","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x148","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000006aba0315493b7e6989041c91181337b662fb1b90","0x000000000000000000000000b300000b72deaeb607a12d5f54773d1c19c7028d"],"data":"0x00000000000000000000000000000000000000000000000000000000024d3aea","blockNumber":"0x15536ea","transactionHash":"0x7cdd1250b267311c73210429aa6aa1cf24446cf22521a6bb591d1d61b0e1e2d8","transactionIndex":"0x72","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x149","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000b300000b72deaeb607a12d5f54773d1c19c7028d","0x0000000000000000000000001231deb6f5749ef6ce6943a275a1d3e7486f4eae"],"data":"0x00000000000000000000000000000000000000000000000000000000024d3aea","blockNumber":"0x15536ea","transactionHash":"0x7cdd1250b267311c73210429aa6aa1cf24446cf22521a6bb591d1d61b0e1e2d8","transactionIndex":"0x72","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x14a","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000b300000b72deaeb607a12d5f54773d1c19c7028d","0x0000000000000000000000001231deb6f5749ef6ce6943a275a1d3e7486f4eae"],"data":"0x00000000000000000000000000000000000000000000000000000000024d3aea","blockNumber":"0x15536ea","transactionHash":"0x7cdd1250b267311c73210429aa6aa1cf24446cf22521a6bb591d1d61b0e1e2d8","transactionIndex":"0x72","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x14b","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000001231deb6f5749ef6ce6943a275a1d3e7486f4eae","0x000000000000000000000000d52abafd35289749cb1587b53cdd35ebe718d583"],"data":"0x00000000000000000000000000000000000000000000000000000000024d3aea","blockNumber":"0x15536ea","transactionHash":"0x7cdd1250b267311c73210429aa6aa1cf24446cf22521a6bb591d1d61b0e1e2d8","transactionIndex":"0x72","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x14c","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000d52abafd35289749cb1587b53cdd35ebe718d583","0x000000000000000000000000a5407eae9ba41422680e2e00537571bcc53efbfd"],"data":"0x00000000000000000000000000000000000000000000000000000000024d3aea","blockNumber":"0x15536ea","transactionHash":"0x7cdd1250b267311c73210429aa6aa1cf24446cf22521a6bb591d1d61b0e1e2d8","transactionIndex":"0x72","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x14d","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000b300000b72deaeb607a12d5f54773d1c19c7028d","0x0000000000000000000000001231deb6f5749ef6ce6943a275a1d3e7486f4eae"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockNumber":"0x15536ea","transactionHash":"0x7cdd1250b267311c73210429aa6aa1cf24446cf22521a6bb591d1d61b0e1e2d8","transactionIndex":"0x72","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x158","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000c7bbec68d12a0d1830360f8ec58fa599ba1b0e9b","0x000000000000000000000000b300000b72deaeb607a12d5f54773d1c19c7028d"],"data":"0x0000000000000000000000000000000000000000000000000000000007afa460","blockNumber":"0x15536ea","transactionHash":"0xc74e4b877f155084699e1dc710e5e80ef70ba53ebdd7e2d79af18169332d9542","transactionIndex":"0x77","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x16c","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000b300000b72deaeb607a12d5f54773d1c19c7028d","0x0000000000000000000000006aba0315493b7e6989041c91181337b662fb1b90"],"data":"0x0000000000000000000000000000000000000000000000000000000007afa460","blockNumber":"0x15536ea","transactionHash":"0xc74e4b877f155084699e1dc710e5e80ef70ba53ebdd7e2d79af18169332d9542","transactionIndex":"0x77","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x16f","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000a35723947d25bdcf0714f19be9bd9779b293128d","0x00000000000000000000000045b7edda606d814048e4ff9884c0b56b0b82a0a6"],"data":"0x000000000000000000000000000000000000000000000000000000000bebd1a0","blockNumber":"0x15536ea","transactionHash":"0x035876cf50ece14e6214a97cb78eeee2e2263e62b03b5f52f8ace584cd34d4d7","transactionIndex":"0xa8","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x1c3","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000049c7db08d3e1e56deb12c41d94a31365d9944562","0x000000000000000000000000fead65e9d5fea3d8848bda557995076cc95e8865"],"data":"0x000000000000000000000000000000000000000000000000000000002bd30650","blockNumber":"0x15536ea","transactionHash":"0x8781f3bf36416fcb001ada8c0be0ee5ca91cf9b24d2a2150aec75a894e34c54b","transactionIndex":"0xba","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x1de","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000c0cb85af8d14e89d31b2ee4cf74640f5de001a32","0x00000000000000000000000081014f44b0a345033bb2b3b21c7a1a308b35feea"],"data":"0x0000000000000000000000000000000000000000000000000000000097655300","blockNumber":"0x15536ea","transactionHash":"0x612ef0b1e15351fb5e4eaf5ecbf604ce991180ad3791f884a7e843134971979e","transactionIndex":"0xbf","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x1e5","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000001c727a55ea3c11b0ab7d3a361fe0f3c47ce6de5d","0x000000000000000000000000827f79cfee1de6f1817734a0b917b9e2f8282ce6"],"data":"0x00000000000000000000000000000000000000000000000000000000019422a1","blockNumber":"0x15536ea","transactionHash":"0x07e22f930fe97b03d151c31d48bf38c00c2dcc338ad6dfcd6a94fcaf0f77e2b2","transactionIndex":"0xc1","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x1e7","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000ce21ce2d6c3b19bff8a84271738965abc85709b7","0x0000000000000000000000002ad831f0c27511f29a9edf83491347aedc2ef586"],"data":"0x0000000000000000000000000000000000000000000000000000000478f4b03d","blockNumber":"0x15536ea","transactionHash":"0x126eb76bd8f6b117f0ba2127d3b78f50f457a1dfe2d4ae13824cb1d397a15283","transactionIndex":"0xc5","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x1eb","removed":false},{"address":"0xdac17f958d2ee523a2206206994597c13d831ec7","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x00000000000000000000000058d70877268e73363bedc432418469e34e172c9e","0x0000000000000000000000003283faf28a3676f19842401b6c66fe586896d817"],"data":"0x000000000000000000000000000000000000000000000000000000000a432b40","blockNumber":"0x15536ea","transactionHash":"0xee4fa67fbc28c0be5ba2f244775ba02a156667f4c22740adee0eed27a554569c","transactionIndex":"0xcb","blockHash":"0xaf8913e030cfbcb24b27dc884b6c0eb383f42c824f341e798f0d51e2850c943e","logIndex":"0x1f1","removed":false}]}`
const debugTraceBlockByNumberResponseCanonicalHash = "2a909c2ccbea632ebd1828b68ce6f48bb83b32477b01b6fc585b92ab6f7717b5"
const debugTraceBlockByNumberResponse string = `{"jsonrpc":"2.0","id":1,"result":[{"type":"CALL","from":"0x3b5b09d988ba5be25d130a6959a7e4dc5cad4578","to":"0x7a250d5630b4cf539739df2c5dacb4c659f2488d","value":"0x2386f26fc10000","gas":"0x55730","gasUsed":"0x3d227","input":"0x7ff36ab5000000000000000000000000000000000000000000000000000b8d442e2d8b000000000000000000000000000003b5b09d988ba5be25d130a6959a7e4dc5cad45780000000000000000000000000000000000000000000000000000000064a571e9","output":"0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000002e90edd00000","calls":[{"type":"CALL","from":"0x7a250d5630b4cf539739df2c5dacb4c659f2488d","to":"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2","value":"0x2386f26fc10000","gas":"0x12e04","gasUsed":"0x8fc","input":"0xd0e30db0","output":"0x","calls":[]},{"type":"CALL","from":"0x7a250d5630b4cf539739df2c5dacb4c659f2488d","to":"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2","value":"0x0","gas":"0x11b36","gasUsed":"0x2c33","input":"0xa9059cbb0000000000000000000000005c69bee701ef814a2b6a3edd4b1652cb9cc5aa6f0000000000000000000000000000000000000000000000000002386f26fc10000","output":"0x0000000000000000000000000000000000000000000000000000000000000001","calls":[]}]},{"type":"CALL","from":"0xf04a5cc80b1e94c69b48f5ee68a08cd2f09a7c3e","to":"0x881d40237659c251811cec9c364ef91dc08d300c","value":"0x0","gas":"0x29dbb","gasUsed":"0x16e0a","input":"0x38ed1739000000000000000000000000000000000000000000000000000429d069189e00000000000000000000000000000000000000000000000000029e8d66e8203c2e0000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000f04a5cc80b1e94c69b48f5ee68a08cd2f09a7c3e0000000000000000000000000000000000000000000000000000000064a571f40000000000000000000000000000000000000000000000000000000000000002000000000000000000000000dac17f958d2ee523a2206206994597c13d831ec70000000000000000000000000d8775f648430679a709e98d2b0cb6250d2887ef","output":"0x0000000000000000000000000000000000000000000000000029e8d66e8203c2e","calls":[]}]}`

func TestEnsureCachedNode_HeapAllocation(t *testing.T) {
	// Create a JsonRpcResponse
	r := &JsonRpcResponse{
		Result: []byte(`{"id":1,"error":null,"result":"value"}`),
	}

	// First call to ensure we have a cached node
	if err := r.ensureCachedNode(); err != nil {
		t.Fatalf("First ensureCachedNode failed: %v", err)
	}

	// Save the address of the cached node
	originalCachedNode := r.cachedNode

	// Verify it's not nil
	if originalCachedNode == nil {
		t.Fatal("cachedNode is nil after initial call")
	}

	// Make a copy of the node data to compare later
	originalNodeValue := *originalCachedNode

	// Run GC to ensure our node stays alive
	for i := 0; i < 10; i++ {
		runtime.GC()
		time.Sleep(10 * time.Millisecond)
	}

	// Second call should use the existing cached node
	if err := r.ensureCachedNode(); err != nil {
		t.Fatalf("Second ensureCachedNode failed: %v", err)
	}

	// Verify the node address stayed the same (proper caching)
	if r.cachedNode != originalCachedNode {
		t.Fatal("cached node address changed on second call")
	}

	// Verify the node content is still intact
	if !reflect.DeepEqual(*r.cachedNode, originalNodeValue) {
		t.Fatal("cached node content changed unexpectedly")
	}
}

func TestJsonRpcResponse_Hash(t *testing.T) {
	t.Parallel()

	tt := []struct {
		name         string
		json         string
		reverseJson  bool
		expectedHash string
	}{
		//hashes can be calculated using printf '{"id":1,"error":null,"result":"123456789"}' | sha256
		// {
		// 	name:         "simple result",
		// 	json:         `{"id":1, "result":"123456789"}`,
		// 	expectedHash: "e5588adf0034da798adcbfb22ce4dbefeb42fc1f1747e77067ade70dc8c2b8df",
		// },
		{
			name:         "eth_getBlockByNumber result",
			json:         ethGetBlockByNumberResponse,
			expectedHash: ethGetBlockByNumberResponseCanonicalHash,
		},
		{
			name:         "eth_getBlockByNumber reversed result",
			json:         ethGetBlockByNumberResponse,
			reverseJson:  true,
			expectedHash: ethGetBlockByNumberResponseCanonicalHash,
		},
		{
			name:         "eth_getLogs result",
			json:         ethGetLogsResponse,
			expectedHash: ethGetLogsResponseCanonicalHash,
		},
		{
			name:         "eth_getLogs reversed result",
			json:         ethGetLogsResponse,
			reverseJson:  true,
			expectedHash: ethGetLogsResponseCanonicalHash,
		},
		{
			name:         "debug_traceBlockByNumber result",
			json:         debugTraceBlockByNumberResponse,
			expectedHash: debugTraceBlockByNumberResponseCanonicalHash,
		},
		{
			name:         "debug_traceBlockByNumber reversed result",
			json:         debugTraceBlockByNumberResponse,
			reverseJson:  true,
			expectedHash: debugTraceBlockByNumberResponseCanonicalHash,
		},
	}
	for _, tc := range tt {
		tc := tc
		t.Run(tc.name, func(t *testing.T) {
			t.Parallel()

			result := tc.json
			if tc.reverseJson {
				var err error
				result, err = reverseLexSortJSON(tc.json)
				require.NoError(t, err)
				require.NotEqual(t, result, tc.json)
			}

			// Create a JsonRpcResponse
			r := &JsonRpcResponse{
				Result: []byte(result),
			}

			hash, err := r.CanonicalHash()
			assert.NoError(t, err)
			assert.Equal(t, tc.expectedHash, hash, "expected hash for result %s", result)
		})
	}
}

// ReverseLexSortJSON recursively sorts JSON object keys in reverse lex order
func reverseLexSortJSON(input string) (string, error) {
	var obj interface{}
	if err := json.Unmarshal([]byte(input), &obj); err != nil {
		return "", fmt.Errorf("invalid JSON: %w", err)
	}

	sorted, err := sortJSONReverse(obj)
	if err != nil {
		return "", err
	}

	return string(sorted), nil
}

// sortJSONReverse recursively sorts JSON keys in reverse lex order
func sortJSONReverse(v interface{}) ([]byte, error) {
	switch v := v.(type) {
	case map[string]interface{}:
		keys := make([]string, 0, len(v))
		for k := range v {
			keys = append(keys, k)
		}
		sort.Sort(sort.Reverse(sort.StringSlice(keys)))

		var buf bytes.Buffer
		buf.WriteByte('{')
		for i, k := range keys {
			keyBytes, _ := json.Marshal(k)
			valBytes, err := sortJSONReverse(v[k])
			if err != nil {
				return nil, err
			}
			buf.Write(keyBytes)
			buf.WriteByte(':')
			buf.Write(valBytes)
			if i < len(keys)-1 {
				buf.WriteByte(',')
			}
		}
		buf.WriteByte('}')
		return buf.Bytes(), nil

	case []interface{}:
		var buf bytes.Buffer
		buf.WriteByte('[')
		for i, item := range v {
			itemBytes, err := sortJSONReverse(item)
			if err != nil {
				return nil, err
			}
			buf.Write(itemBytes)
			if i < len(v)-1 {
				buf.WriteByte(',')
			}
		}
		buf.WriteByte(']')
		return buf.Bytes(), nil

	default:
		return json.Marshal(v)
	}
}

func TestJsonRpcRequest_MarshalParams(t *testing.T) {
	t.Run("Empty", func(t *testing.T) {
		rawReq, err := SonicCfg.Marshal(JsonRpcRequest{
			JSONRPC: "2.0",
			ID:      1,
			Method:  "eth_blockNumber",
			Params:  []interface{}{},
		})
		assert.NoError(t, err)

		expectedRawReq := `{"jsonrpc":"2.0","id":1,"method":"eth_blockNumber","params":[]}`
		assert.Equal(t, expectedRawReq, string(rawReq))
	})

	t.Run("Value", func(t *testing.T) {
		rawReq, err := SonicCfg.Marshal(JsonRpcRequest{
			JSONRPC: "2.0",
			ID:      1,
			Method:  "eth_blockNumber",
			Params:  []interface{}{"0xcafecafecafecafecafecafecafecafecafecafe"},
		})
		assert.NoError(t, err)

		expectedRawReq := `{"jsonrpc":"2.0","id":1,"method":"eth_blockNumber","params":["0xcafecafecafecafecafecafecafecafecafecafe"]}`
		assert.Equal(t, expectedRawReq, string(rawReq))
	})
}

func TestJsonRpcResponse_CanonicalHash_EmptyishNormalization(t *testing.T) {
	// Test cases that should produce the same hash due to emptyish normalization
	testGroups := []struct {
		name     string
		variants []string
	}{
		{
			name: "empty arrays vs non-existing fields",
			variants: []string{
				`{"result": {"data": "0x123", "logs": []}}`,
				`{"result": {"data": "0x123"}}`,
				`{"result": {"data": "0x123", "logs": null}}`,
			},
		},
		{
			name: "null values vs non-existing fields",
			variants: []string{
				`{"result": {"from": "0xabc", "to": null}}`,
				`{"result": {"from": "0xabc"}}`,
				`{"result": {"from": "0xabc", "to": ""}}`,
			},
		},
		{
			name: "empty strings and hex values",
			variants: []string{
				`{"result": {"data": "", "value": "0x123"}}`,
				`{"result": {"data": "0x", "value": "0x123"}}`,
				`{"result": {"data": "0x0", "value": "0x123"}}`,
				`{"result": {"value": "0x123"}}`,
			},
		},
		{
			name: "nested empty objects",
			variants: []string{
				`{"result": {"block": {"transactions": []}, "status": "ok"}}`,
				`{"result": {"block": {}, "status": "ok"}}`,
				`{"result": {"status": "ok"}}`,
			},
		},
		{
			name: "field ordering should not matter",
			variants: []string{
				`{"result": {"a": "1", "b": "2", "c": "3"}}`,
				`{"result": {"c": "3", "a": "1", "b": "2"}}`,
				`{"result": {"b": "2", "c": "3", "a": "1"}}`,
			},
		},
		{
			name: "real-world example - transaction fields with nulls",
			variants: []string{
				`{"result": {"hash": "0xabc", "from": "0x123", "to": "0x456", "accessList": [], "chainId": null, "yParity": null}}`,
				`{"result": {"hash": "0xabc", "from": "0x123", "to": "0x456"}}`,
				`{"result": {"from": "0x123", "hash": "0xabc", "to": "0x456", "accessList": null}}`,
			},
		},
		{
			name: "array with empty elements",
			variants: []string{
				`{"result": {"items": ["a", "", "c"]}}`,
				`{"result": {"items": ["a", null, "c"]}}`,
				`{"result": {"items": ["a", "0x", "c"]}}`,
			},
		},
	}

	for _, group := range testGroups {
		group := group
		t.Run(group.name, func(t *testing.T) {
			t.Parallel()

			var hashes []string
			for i, variant := range group.variants {
				resp := &JsonRpcResponse{
					Result: []byte(variant),
				}
				hash, err := resp.CanonicalHash()
				assert.NoError(t, err, "variant %d: %s", i, variant)
				hashes = append(hashes, hash)
			}

			// All variants in the group should produce the same hash
			for i := 1; i < len(hashes); i++ {
				assert.Equal(t, hashes[0], hashes[i],
					"Hash mismatch between variant 0 and variant %d\nVariant 0: %s\nVariant %d: %s",
					i, group.variants[0], i, group.variants[i])
			}
		})
	}

	// Test cases that should produce different hashes
	t.Run("different values should produce different hashes", func(t *testing.T) {
		cases := []string{
			`{"result": {"value": "0x123"}}`,
			`{"result": {"value": "0x456"}}`,
			`{"result": {"value": "123"}}`,
			`{"result": {"data": "0x123"}}`,
		}

		hashes := make(map[string]bool)
		for _, c := range cases {
			resp := &JsonRpcResponse{Result: []byte(c)}
			hash, err := resp.CanonicalHash()
			assert.NoError(t, err)
			assert.False(t, hashes[hash], "Duplicate hash found for: %s", c)
			hashes[hash] = true
		}
		assert.Equal(t, len(cases), len(hashes), "Expected all different hashes")
	})

	// Test the specific shadow response example
	t.Run("shadow response normalization", func(t *testing.T) {
		// Simplified version of the shadow response example
		original := `{
			"result": {
				"hash": "0xa52b",
				"transactions": [{
					"hash": "0x18c4",
					"from": "0x3d2f",
					"chainId": null,
					"accessList": []
				}]
			}
		}`

		shadow := `{
			"result": {
				"transactions": [{
					"from": "0x3d2f",
					"hash": "0x18c4"
				}],
				"hash": "0xa52b"
			}
		}`

		resp1 := &JsonRpcResponse{Result: []byte(original)}
		resp2 := &JsonRpcResponse{Result: []byte(shadow)}

		hash1, err1 := resp1.CanonicalHash()
		hash2, err2 := resp2.CanonicalHash()

		assert.NoError(t, err1)
		assert.NoError(t, err2)
		assert.Equal(t, hash1, hash2, "Shadow response should have same canonical hash")
	})
}
